<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Monicas House Roma</title>
    <link rel="stylesheet" href="monicashouseroma.css">
</head>
<body id="body">
  <div id="intestazione">
    <h1 id="titolo">Monica's House Roma</h1>
    <h2 id="titolo">ITO58091C2TV8YA317</h2>
    <select id="lingua" onchange="selezionaLingua(this.value)">
      <option value="it">üáÆüáπ Italiano</option>
      <option value="en">üá¨üáß English</option>
      <option value="fr">üá´üá∑ Fran√ßais</option>
      <option value="td">üá©üá™ Deutsch</option>
      <option value="sp">üá™üá∏ Espa√±ol</option>
      <option value="rs">üá∑üá∫ Russian (Latin)</option>
      <option value="rsc">üá∑üá∫ Russian (Cyrillic)</option>
    </select>
  </div>

  <nav id="navbar">
    <ul>
      <li><a id="nav-home" href="#" onclick="mostraSezione('home'); return false;">Home</a></li>
      <li><a id="nav-descrizione" href="#" onclick="mostraSezione('descrizione'); return false;">Descrizione</a></li>
      <li><a id="nav-recensioni" href="#" onclick="mostraSezione('recensioni'); return false;">Recensioni</a></li>
    </ul>
  </nav>

  <div id="categoria-selector" style="text-align:center; margin-top:10px;">
    <label for="categoria">Seleziona categoria:</label>
    <select id="categoria" onchange="selezionaCategoria(this.value)">
      <option value="salone">Salone</option>
      <option value="bagno">Bagno</option>
      <option value="camera">Camera</option>
      <option value="esterno">Esterno</option>
      <option value="cucina">Cucina</option>
    </select>
  </div>

    <div id="sezione-foto">
      <div id="immagine">
          <img id="carousel-img" src="Salone/TUSCOLANA 001.jpg" alt="Foto">
          <div class="bottone">
            <button onclick="immaginePrecedente()">‚Üê Immagine precedente </button>
            <button onclick="cambiaImmagine()">Immagine successiva ‚Üí</button>
          </div>
      </div>
    </div> <!-- chiude sezione-foto -->
    <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>
    <script>
      const categorie = {
        salone: [],
        bagno: [],
        camera: [],
        esterno: [],
        cucina: []
      };

      // Da 001 a 009 per esterno
      for (let i = 1; i <= 9; i++) {
        const numero = i.toString().padStart(3, '0');
        categorie.esterno.push(`Esterno/TUSCOLANA ${numero}.jpg`);
      }

      // Da 011 a 022 per camera
      for (let i = 11; i <= 22; i++) {
        const numero = i.toString().padStart(3, '0');
        categorie.camera.push(`Camera/TUSCOLANA ${numero}.jpg`);
      }

      // Da 024 a 030 per salone
      for (let i = 24; i <= 30; i++) {
        const numero = i.toString().padStart(3, '0');
        categorie.salone.push(`Salone/TUSCOLANA ${numero}.jpg`);
      }

      // Da 035 a 041 per bagno
      for (let i = 35; i <= 41; i++) {
        const numero = i.toString().padStart(3, '0');
        categorie.bagno.push(`Bagno/TUSCOLANA ${numero}.jpg`);
      }
      
      // Da 042 a 045 per cucina
      for (let i = 42; i <= 45; i++) {
        const numero = i.toString().padStart(3, '0');
        categorie.cucina.push(`Cucina/TUSCOLANA ${numero}.jpg`);
      }
      let categoriaSelezionata = "salone";
      let indiceCorrente = 0;
      
      function selezionaCategoria(cat) {
        categoriaSelezionata = cat;
        indiceCorrente = 0;
        document.getElementById("carousel-img").src = categorie[categoriaSelezionata][indiceCorrente];
      }

      function cambiaImmagine() {
        const immagini = categorie[categoriaSelezionata];
        indiceCorrente = (indiceCorrente + 1) % immagini.length;
        document.getElementById("carousel-img").src = immagini[indiceCorrente];
      }

      function immaginePrecedente() {
        const immagini = categorie[categoriaSelezionata];
        indiceCorrente = (indiceCorrente - 1 + immagini.length) % immagini.length;
        document.getElementById("carousel-img").src = immagini[indiceCorrente];
      }
    </script>
    
    <div id="sezione-descrizione" style="display:none;">
      <div id="descrizione">
  
      <!-- testi italiani -->
      <h4 class="it">LUMINOSO APPARTAMENTO CON AMPIO TERRAZZO</h4>
      <p class="it">
        Rilassati in questo spazio tranquillo in una posizione centrale di Roma.<br>
        Finemente ristrutturato nel 2025 a 50 metri dalla fermata della metro Re di Roma.<br>
        Ideale per coppie.
      </p>
      <ul class="it">
        <li>Cucina attrezzata</li>
        <li>Wi-Fi gratuita</li>
        <li>TV da 36 pollici</li>
        <li>Lavatrice</li>
        <li>Lavastoviglie</li>
        <li>Asciugacapelli</li>
        <li>Ferro da stiro</li>
      </ul>
      <p class="it">
        Contatti:<br>
        <a href="mailto:Monicashouseroma@gmail.com">Monicashouseroma@gmail.com</a>
      </p>

      <!-- testi inglesi -->
      <h4 class="en">BRIGHT APARTMENT WITH LARGE TERRACE</h4>
      <p class="en">
        Relax in this quiet space in a central area of Rome.<br>
        Fully renovated in 2025, just 50 meters from Re di Roma metro stop.<br>
        Perfect for couples.
      </p>
      <ul class="en">
        <li>Fully equipped kitchen</li>
        <li>Free Wi-Fi</li>
        <li>36-inch TV</li>
        <li>Washing machine</li>
        <li>Dishwasher</li>
        <li>Hairdryer</li>
        <li>Iron</li>
      </ul>
      <p class="en">
        Contacts:<br>
        <a href="mailto:Monicashouseroma@gmail.com">Monicashouseroma@gmail.com</a>
      </p>

      <!--- testi francesi -->
      <h4 class="fr">APPARTEMENT LUMINEUX AVEC GRANDE TERRASSE</h4>
      <p class="fr">
        D√©tendez-vous dans cet espace calme dans un emplacement central √† Rome.<br>
        Finement r√©nov√© en 2025, √† 50 m√®tres de la station de m√©tro Re di Roma.<br>
        Id√©al pour les couples.
      </p>
      <ul class="fr">
        <li>Cuisine √©quip√©e</li>
        <li>Wi-Fi gratuit</li>
        <li>T√©l√©viseur 36 pouces</li>
        <li>Machine √† laver</li>
        <li>Lave-vaisselle</li>
        <li>S√®che-cheveux</li>
        <li>Fer</li>
      </ul>
      <p class="fr">
        Contacts:<br>
        <a href="mailto:Monicashouseroma@gmail.com">Monicashouseroma@gmail.com</a>
      </p>

      <!-- testi tedesco --> 
      <h4 class="td">HELLE WOHNUNG MIT GROSSER TERRASSE</h4>
      <p class="td">
        Entspannen Sie sich in diesem ruhigen Ort in zentraler Lage in Rom.<br>
        Im Jahr 2025 fein renoviert, 50 Meter von der U-Bahn-Haltestelle Re di Roma entfernt.<br>
        Ideal f√ºr Paare.
      </p>
      <ul class="td">
        <li>Ausgestattete K√ºche</li>
        <li>Kostenloses WLAN</li>
        <li>36-Zoll-Fernseher</li>
        <li>Waschmaschine</li>
        <li>Sp√ºlmaschine</li>
        <li>F√∂n</li>
        <li>Eisen</li>
      </ul>
      <p class="td">
        Kontakte:<br>
        <a href="mailto:Monicashouseroma@gmail.com">Monicashouseroma@gmail.com</a>
      </p>

      <!-- testi spagnolo -->
      <h4 class="sp">PISO LUMINOSO CON GRAN TERRAZA</h4>
      <p class="sp">
        Rel√°jese en este espacio tranquilo en una ubicaci√≥n central en Roma.<br>
        Finamente renovado en 2025, a 50 metros de la parada de metro Re di Roma.<br>
        Ideal para parejas.
      </p>
      <ul class="sp">
        <li>Cocina equipada</li>
        <li>Wi-Fi gratuito</li>
        <li>Televisor de 36 pulgadas</li>
        <li>Lavadora</li>
        <li>Lavavajillas</li>
        <li>Secador de pelo</li>
        <li>Hierro</li>
      </ul>
      <p class="sp">
        Contactos:<br>
        <a href="mailto:Monicashouseroma@gmail.com">Monicashouseroma@gmail.com</a>
      </p>

      <!-- testi russo -->
      <h4 class="rs">SVETLAYA KVARTIRA S BOL'SHOY TERRASOY</h4>
      <p class="rs">
        Otdokhnite v etom tikhom meste v tsentre Roma.<br>
        Remont sdelan v 2025 godu, v 50 metrakh ot stantsii metro Re di Roma.<br>
        Ideal'no podkhodit dlya par.
      </p>
      <ul class="rs">
        <li>Oborudovannaya kukhnya</li>
        <li>Besplatnyy Wi-Fi</li>
        <li>36-dyuymovyy televizor</li>
        <li>Stiral'naya mashina</li>
        <li>Posudomoyechnaya mashina</li>
        <li>Fen</li>
        <li>Zhelezo</li>
      </ul>
      <p class="rs">
        Kontakty:<br>
        <a href="mailto:Monicashouseroma@gmail.com">Monicashouseroma@gmail.com</a>
      </p>

      <!-- testi russi cirillico -->
      <h4 class="rsc">–°–í–ï–¢–õ–ê–Ø –ö–í–ê–†–¢–ò–†–ê –° –ë–û–õ–¨–®–û–ô –¢–ï–†–†–ê–°–û–ô</h4>
      <p class="rsc">
        –û—Ç–¥–æ—Ö–Ω–∏—Ç–µ –≤ —ç—Ç–æ–º —Ç–∏—Ö–æ–º –º–µ—Å—Ç–µ –≤ —Ü–µ–Ω—Ç—Ä–µ Roma.<br>
        –†–µ–º–æ–Ω—Ç —Å–¥–µ–ª–∞–Ω –≤ 2025 –≥–æ–¥—É, –≤ 50 –º–µ—Ç—Ä–∞—Ö –æ—Ç —Å—Ç–∞–Ω—Ü–∏–∏ –º–µ—Ç—Ä–æ Re di Roma.<br>
        –ò–¥–µ–∞–ª—å–Ω–æ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –ø–∞—Ä.
      </p>
      <ul class="rsc">
        <li>–û–±–æ—Ä—É–¥–æ–≤–∞–Ω–Ω–∞—è –∫—É—Ö–Ω—è</li>
        <li>–ë–µ—Å–ø–ª–∞—Ç–Ω—ã–π Wi-Fi</li>
        <li>36-–¥—é–π–º–æ–≤—ã–π —Ç–µ–ª–µ–≤–∏–∑–æ—Ä</li>
        <li>–°—Ç–∏—Ä–∞–ª—å–Ω–∞—è –º–∞—à–∏–Ω–∞</li>
        <li>–ü–æ—Å—É–¥–æ–º–æ–µ—á–Ω–∞—è –º–∞—à–∏–Ωa</li>
        <li>–§–µ–Ω</li>
        <li>a –£—Ç—ér</li>
      </ul>
      <p class="rsc">
        Contactos:<br>
        <a href="mailto:Monicashouseroma@gmail.com">Monicashouseroma@gmail.com</a>
      </p>
    </div> <!-- chiude descrizione -->
  </div> <!-- chiude sezione-descrizione -->

  <div id="sezione-recensioni" style="display:none;">
    <div class="recensioni">
      <div class="review-source">
        <a id="btn-airbnb" class="btn" href="https://www.airbnb.it/users/show/675653193" target="_blank" rel="noopener">Leggi tutte le recensioni su Airbnb ‚Üó</a>
      </div>
      <div class="elfsight-app-REPLACE_WITH_YOUR_APP_ID"></div>
      <h3>Recensioni</h3>
      <form id="review-form" class="review-form" onsubmit="inviaRecensione(event)">
        <div class="form-row">
          <label for="rev-name" id="lbl-rev-name">Nome</label>
          <input type="text" id="rev-name" name="name" required maxlength="50" placeholder="Il tuo nome" />
        </div>
        <div class="form-row">
          <span id="lbl-rev-rating">Valutazione</span>
          <div class="stars" id="rev-stars" aria-label="Valutazione da 1 a 5">
            <button type="button" data-val="1" aria-label="1">‚òÖ</button>
            <button type="button" data-val="2" aria-label="2">‚òÖ</button>
            <button type="button" data-val="3" aria-label="3">‚òÖ</button>
            <button type="button" data-val="4" aria-label="4">‚òÖ</button>
            <button type="button" data-val="5" aria-label="5">‚òÖ</button>
            <input type="hidden" id="rev-rating" name="rating" value="5" />
          </div>
        </div>
        <div class="form-row">
          <label for="rev-text" id="lbl-rev-text">La tua recensione</label>
          <textarea id="rev-text" name="text" rows="4" required maxlength="500" placeholder="Racconta la tua esperienza‚Ä¶"></textarea>
          <div class="char-counter" id="rev-counter">0/500</div>
        </div>
        <!-- honeypot anti-spam -->
        <input type="text" id="rev-website" name="website" style="display:none" tabindex="-1" autocomplete="off" />
        <div class="form-row">
          <button class="btn" id="btn-rev-submit" type="submit">Invia recensione</button>
        </div>
        <p class="form-note" id="rev-privacy">Inviando, accetti che la recensione sia mostrata pubblicamente. Nessun dato viene condiviso con terze parti.</p>
        <p class="form-success" id="rev-success" style="display:none;">Grazie! La tua recensione √® stata aggiunta.</p>
      </form>

      <div id="reviews-list" class="reviews-list"></div>
    </div>
  </div>
    <script>
      let lingua = "it";

            // ---- Firebase config & init ----
            const firebaseConfig = {
        apiKey: "AIzaSyCaEmqB9Xxn5DpEKf63u1GQstNU3VIg-xc",
        authDomain: "monicashouse-5da13.firebaseapp.com",
        projectId: "monicashouse-5da13",
        storageBucket: "monicashouse-5da13.appspot.com",
        messagingSenderId: "133275293239",
        appId: "1:133275293239:web:2d3ff47fb2e852533611b2",
        measurementId: "G-08PNL2X62"
      };
      const app = firebase.initializeApp(firebaseConfig);
      const db = firebase.firestore();

      // ---- Page view counter (hidden; logs only if admin flag is set locally) ----
      function isAdminViewer() {
        // Abilita i log solo per te eseguendo in console:
        // localStorage.setItem('mh_admin', '1')
        try { return localStorage.getItem('mh_admin') === '1'; } catch (_) { return false; }
      }

async function trackPageView() {
  try {
    const ref = db.collection('metrics').doc('pageViews');
    await ref.set({
      count: firebase.firestore.FieldValue.increment(1),
      last: firebase.firestore.FieldValue.serverTimestamp()
    }, { merge: true });

    if (isAdminViewer()) {
      const snap = await ref.get();
      const c = (snap.exists && snap.data().count) ? snap.data().count : 0;
      console.log(`[Monica's House] Page views totali: ${c}`);
    }
  } catch (e) {
    if (isAdminViewer()) console.warn('Counter error:', e);
  }
}

      const testi = {
        it: {
          precedente: "‚Üê Immagine precedente",
          successiva: "Immagine successiva ‚Üí",
          categoria: "Seleziona categoria:",
          salone: "Salone",
          bagno: "Bagno",
          camera: "Camera",
          esterno: "Esterno",
          cucina: "Cucina",
          nav_home: "Home",
          nav_descrizione: "Descrizione",
          nav_recensioni: "Recensioni",
          airbnb_btn: "Leggi tutte le recensioni su Airbnb ‚Üó",
          rev_name: "Nome",
          rev_rating: "Valutazione",
          rev_text: "La tua recensione",
          rev_placeholder: "Racconta la tua esperienza‚Ä¶",
          rev_submit: "Invia recensione",
          rev_privacy: "Inviando, accetti che la recensione sia mostrata pubblicamente. Nessun dato viene condiviso con terze parti.",
          rev_success: "Grazie! La tua recensione √® stata aggiunta."
        },
        en: {
          precedente: "‚Üê Previous image",
          successiva: "Next image ‚Üí",
          categoria: "Select category:",
          salone: "Living room",
          bagno: "Bathroom",
          camera: "Bedroom",
          esterno: "Outdoor",
          cucina: "Kitchen",
          nav_home: "Home",
          nav_descrizione: "Description",
          nav_recensioni: "Reviews",
          airbnb_btn: "Read all reviews on Airbnb ‚Üó",
          rev_name: "Name",
          rev_rating: "Rating",
          rev_text: "Your review",
          rev_placeholder: "Share your experience‚Ä¶",
          rev_submit: "Send review",
          rev_privacy: "By sending, you agree your review may be shown publicly. No data is shared with third parties.",
          rev_success: "Thanks! Your review has been added."
        },
        fr: {
          precedente: "‚Üê Image pr√©c√©dente",
          successiva: "Image suivante ‚Üí",
          categoria: "S√©lectionnez la cat√©gorie¬†:",
          salone: "Salon",
          bagno: "Salle de bain",
          camera: "Chambre",
          esterno: "Ext√©rieur",
          cucina: "Cuisine",
          nav_home: "Accueil",
          nav_descrizione: "Description",
          nav_recensioni: "Avis",
          airbnb_btn: "Lire tous les avis sur Airbnb ‚Üó",
          rev_name: "Nom",
          rev_rating: "Note",
          rev_text: "Votre avis",
          rev_placeholder: "Partagez votre exp√©rience‚Ä¶",
          rev_submit: "Envoyer l‚Äôavis",
          rev_privacy: "En envoyant, vous acceptez que l‚Äôavis soit affich√© publiquement. Aucune donn√©e partag√©e avec des tiers.",
          rev_success: "Merci ! Votre avis a √©t√© ajout√©."
        },
        td: {
          precedente: "‚Üê Vorheriges Bild",
          successiva: "N√§chstes Bild ‚Üí",
          categoria: "Kategorie ausw√§hlen:",
          salone: "Wohnzimmer",
          bagno: "Badezimmer",
          camera: "Schlafzimmer",
          esterno: "Au√üenbereich",
          cucina: "K√ºche",
          nav_home: "Startseite",
          nav_descrizione: "Beschreibung",
          nav_recensioni: "Bewertungen",
          airbnb_btn: "Alle Bewertungen auf Airbnb lesen ‚Üó",
          rev_name: "Name",
          rev_rating: "Bewertung",
          rev_text: "Ihre Rezension",
          rev_placeholder: "Teilen Sie Ihre Erfahrung‚Ä¶",
          rev_submit: "Rezension senden",
          rev_privacy: "Mit dem Senden stimmen Sie der √∂ffentlichen Anzeige zu. Keine Daten an Dritte weitergegeben.",
          rev_success: "Danke! Ihre Rezension wurde hinzugef√ºgt."
        },
        sp: {
          precedente: "‚Üê Imagen anterior",
          successiva: "Imagen siguiente ‚Üí",
          categoria: "Selecciona categor√≠a:",
          salone: "Sal√≥n",
          bagno: "Ba√±o",
          camera: "Dormitorio",
          esterno: "Exterior",
          cucina: "Cocina",
          nav_home: "Inicio",
          nav_descrizione: "Descripci√≥n",
          nav_recensioni: "Rese√±as",
          airbnb_btn: "Leer todas las rese√±as en Airbnb ‚Üó",
          rev_name: "Nombre",
          rev_rating: "Valoraci√≥n",
          rev_text: "Tu rese√±a",
          rev_placeholder: "Comparte tu experiencia‚Ä¶",
          rev_submit: "Enviar rese√±a",
          rev_privacy: "Al enviar, aceptas que la rese√±a se muestre p√∫blicamente. No se comparten datos con terceros.",
          rev_success: "¬°Gracias! Tu rese√±a ha sido a√±adida."
        },
        rs: {
          precedente: "‚Üê Predydushchaya kartinka",
          successiva: "Sleduyushchaya kartinka ‚Üí",
          categoria: "Vyberite kategoriyu:",
          salone: "Gostinaya",
          bagno: "Vannaya",
          camera: "Spalnya",
          esterno: "Ulitsa",
          cucina: "Kukhnya",
          nav_home: "Domoy",
          nav_descrizione: "Opisaniye",
          nav_recensioni: "Otzivy",
          airbnb_btn: "Prochitat' vse otzyvy na Airbnb ‚Üó",
          rev_name: "Imya",
          rev_rating: "Ocenka",
          rev_text: "Vash otzyv",
          rev_placeholder: "Podelites' opytom‚Ä¶",
          rev_submit: "Otdat' otzyv",
          rev_privacy: "Otpravlyaya, vy soglashaetes', chto otzyv budet publichnym. Dannyye ne peredayutsya tretym litsam.",
          rev_success: "Spasibo! Vash otzyv dobavlen."
        },
        rsc: {
          precedente: "‚Üê –ü—Ä–µ–¥—ã–¥—É—â–µ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ",
          successiva: "–°–ª–µ–¥—É—é—â–µ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ ‚Üí",
          categoria: "–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é:",
          salone: "–ì–æ—Å—Ç–∏–Ω–∞—è",
          bagno: "–í–∞–Ω–Ω–∞—è",
          camera: "–°–ø–∞–ª—å–Ω—è",
          esterno: "–°–Ω–∞—Ä—É–∂–∏",
          cucina: "–ö—É—Ö–Ω—è",
          nav_home: "–î–æ–º–æ–π",
          nav_descrizione: "–û–ø–∏—Å–∞–Ω–∏–µ",
          nav_recensioni: "–û—Ç–∑—ã–≤—ã",
          airbnb_btn: "–ü—Ä–æ—á–∏—Ç–∞—Ç—å –≤—Å–µ –æ—Ç–∑—ã–≤—ã –Ω–∞ Airbnb ‚Üó",
          rev_name: "–ò–º—è",
          rev_rating: "–û—Ü–µ–Ω–∫–∞",
          rev_text: "–í–∞—à –æ—Ç–∑—ã–≤",
          rev_placeholder: "–ü–æ–¥–µ–ª–∏—Ç–µ—Å—å —Å–≤–æ–∏–º –æ–ø—ã—Ç–æ–º‚Ä¶",
          rev_submit: "–û—Ç–ø—Ä–∞–≤–∏—Ç—å –æ—Ç–∑—ã–≤",
          rev_privacy: "–û—Ç–ø—Ä–∞–≤–ª—è—è, –≤—ã —Å–æ–≥–ª–∞—à–∞–µ—Ç–µ—Å—å –Ω–∞ –ø—É–±–ª–∏—á–Ω–æ–µ —Ä–∞–∑–º–µ—â–µ–Ω–∏–µ –æ—Ç–∑—ã–≤–∞. –î–∞–Ω–Ω—ã–µ –Ω–µ –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è —Ç—Ä–µ—Ç—å–∏–º –ª–∏—Ü–∞–º.",
          rev_success: "–°–ø–∞—Å–∏–±–æ! –í–∞—à –æ—Ç–∑—ã–≤ –¥–æ–±–∞–≤–ª–µ–Ω."
        }
      };


      function selezionaLingua(lang) {
        lingua = lang;
        // Nasconde i testi
        document.querySelectorAll(".it, .en, .fr, .td, .sp, .rs, .rsc").forEach(el => el.style.display = "none");

        // Mostra solo la lingua corrente
        document.querySelectorAll("." + lingua).forEach(el => el.style.display = "block");

        // Aggiorna i testi dei bottoni e categorie
        document.querySelector(".bottone button:first-child").innerText = testi[lingua].precedente;
        document.querySelector(".bottone button:last-child").innerText = testi[lingua].successiva;
        document.querySelector('label[for="categoria"]').innerText = testi[lingua].categoria;

        const btnAirbnb = document.getElementById("btn-airbnb");
        if (btnAirbnb) btnAirbnb.innerText = testi[lingua].airbnb_btn;

        const catSelect = document.getElementById("categoria");
        catSelect.options[0].text = testi[lingua].salone;
        catSelect.options[1].text = testi[lingua].bagno;
        catSelect.options[2].text = testi[lingua].camera;
        catSelect.options[3].text = testi[lingua].esterno;
        catSelect.options[4].text = testi[lingua].cucina;
        document.getElementById("nav-home").innerText = testi[lingua].nav_home;
        document.getElementById("nav-descrizione").innerText = testi[lingua].nav_descrizione;
        document.getElementById("nav-recensioni").innerText = testi[lingua].nav_recensioni;
        // Localizza form recensioni
        const lblName = document.getElementById('lbl-rev-name');
        const lblRating = document.getElementById('lbl-rev-rating');
        const lblText = document.getElementById('lbl-rev-text');
        const nameInput = document.getElementById('rev-name');
        const textInput = document.getElementById('rev-text');
        const btnSubmit = document.getElementById('btn-rev-submit');
        const pPrivacy = document.getElementById('rev-privacy');
        const pSuccess = document.getElementById('rev-success');
        if (lblName) lblName.innerText = testi[lingua].rev_name;
        if (lblRating) lblRating.innerText = testi[lingua].rev_rating;
        if (lblText) lblText.innerText = testi[lingua].rev_text;
        if (nameInput) nameInput.placeholder = testi[lingua].rev_name;
        if (textInput) textInput.placeholder = testi[lingua].rev_placeholder;
        if (btnSubmit) btnSubmit.innerText = testi[lingua].rev_submit;
        if (pPrivacy) pPrivacy.innerText = testi[lingua].rev_privacy;
        if (pSuccess) pSuccess.innerText = testi[lingua].rev_success;
      }

      window.onload = () => {
        selezionaLingua(lingua);
        document.getElementById("lingua").value = lingua;
        const selezione = document.getElementById("categoria").value;
        selezionaCategoria(selezione);
        mostraSezione('home');
      };

      function sanitize(str) {
        return (str || '').toString().replace(/[<>]/g, '');
      }
      function linguaToLocale(l) {
        const map = { it: 'it-IT', en: 'en-GB', fr: 'fr-FR', td: 'de-DE', sp: 'es-ES', rs: 'ru-RU', rsc: 'ru-RU' };
        return map[l] || 'it-IT';
      }
      function formatReviewDate(ts) {
        try {
          const d = ts && typeof ts.toDate === 'function' ? ts.toDate() : (ts ? new Date(ts) : null);
          if (!d || isNaN(d)) return '';
          return d.toLocaleDateString(linguaToLocale(lingua), { year: 'numeric', month: 'short', day: '2-digit' });
        } catch (_) { return ''; }
      }
      async function renderReviews() {
        const container = document.getElementById('reviews-list');
        if (!container) return;
        container.innerHTML = '';
        try {
          const snap = await db.collection('reviews').orderBy('created_at', 'desc').get();
          snap.forEach(doc => {
            const r = doc.data();
            const stars = '‚òÖ'.repeat(r.rating || 0) + '‚òÜ'.repeat(5 - (r.rating || 0));
            const card = document.createElement('div');
            card.className = 'review-card';
            const dateTxt = formatReviewDate(r.created_at);
            card.innerHTML = `
              <p class="review-text">${sanitize(r.text)}</p>
              <p class="review-author">‚Äî ${sanitize(r.name)} ¬∑ ${stars}${dateTxt ? ' ¬∑ ' + dateTxt : ''}</p>
            `;
            container.appendChild(card);
          });
        } catch (err) {
          console.error('Errore nel caricamento recensioni:', err);
        }
      }
      function bindStars() {
        const wrap = document.getElementById('rev-stars');
        if (!wrap) return;
        const buttons = wrap.querySelectorAll('button[data-val]');
        const input = document.getElementById('rev-rating');
        const setActive = (val) => {
          buttons.forEach(b => {
            const on = Number(b.dataset.val) <= val;
            b.classList.toggle('active', on);
            b.setAttribute('aria-pressed', on ? 'true' : 'false');
          });
        };
        buttons.forEach(b => {
          b.addEventListener('click', () => {
            const val = Number(b.dataset.val);
            input.value = val;
            setActive(val);
            wrap.setAttribute('aria-label', `Valutazione: ${val} su 5`);
          });
        });
        setActive(Number(input.value || 5));
      }
      async function inviaRecensione(e) {
        e.preventDefault();
        const hp = document.getElementById('rev-website');
        if (hp && hp.value) return; // honeypot
        const name = document.getElementById('rev-name').value.trim();
        const rating = Math.max(1, Math.min(5, Number(document.getElementById('rev-rating').value || 5)));
        const text = document.getElementById('rev-text').value.trim();
        if (!name || !text) return;
        try {
          await db.collection('reviews').add({
            name,
            rating,
            text,
            created_at: firebase.firestore.FieldValue.serverTimestamp()
          });
          document.getElementById('review-form').reset();
          document.getElementById('rev-rating').value = 5;
          bindStars();
          const success = document.getElementById('rev-success');
          if (success) { success.style.display = 'block'; setTimeout(()=> success.style.display='none', 4000); }
          renderReviews();
        } catch (err) {
          console.error('Errore durante il salvataggio:', err);
          alert('Errore durante l\'invio della recensione.');
        }
      }
      const txtArea = document.getElementById('rev-text');
      if (txtArea) {
        txtArea.addEventListener('input', () => {
          const c = document.getElementById('rev-counter');
          if (c) c.innerText = `${txtArea.value.length}/500`;
        });
      }
      function cancellaRecensioni() {
        alert('Le recensioni ora sono salvate su Firebase Firestore. Per cancellarle definitivamente usa la Console Firebase (Firestore ‚Üí raccolta "reviews").');
      }

      // init widgets when page loads
      document.addEventListener('DOMContentLoaded', () => {
        bindStars();
        const btnClear = document.getElementById('btn-rev-clear');
        if (btnClear) btnClear.style.display = 'none';
        renderReviews();
        trackPageView();
      });

    </script>
      <div id="contatti-fissi" style="text-align: center; margin-top: 20px;">
        <p>Contatti:<br>
          <a href="mailto:Monicashouseroma@gmail.com">Monicashouseroma@gmail.com</a>
        </p>
      </div>
      <script>
        function mostraSezione(sezione) {
          const mappa = {
            home: 'sezione-foto',
            foto: 'sezione-foto',
            descrizione: 'sezione-descrizione',
            recensioni: 'sezione-recensioni'
          };

          const sezioni = ['sezione-foto', 'sezione-descrizione', 'sezione-recensioni'];
          sezioni.forEach(id => {
            const el = document.getElementById(id);
            if (el) el.style.display = 'none';
          });

          const targetId = mappa[sezione] || 'sezione-foto';
          const target = document.getElementById(targetId);
          if (target) target.style.display = 'block';
          const catSel = document.getElementById("categoria-selector");
          if (catSel) {
            catSel.style.display = (targetId === 'sezione-foto') ? 'block' : 'none';
          }
        }
      </script>
</body>
</html>